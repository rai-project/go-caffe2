# Docker image
# Build a Docker image to deploy, run, or push to a container registry.
# Add steps that use Docker Compose, tag images, push to a registry, run an image, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/docker

pool:
  vmImage: 'Ubuntu 16.04'

steps:
- displayName: build/push docker
  bash: |
    docker login -u $(dockerId) -p $(pswd)
    cd ${TRAVIS_BUILD_DIR}/dockerfiles
    make docker_build_cpu
    make docker_push_cpu
- displayName: build/push docker
  bash: |
    docker login -u $(dockerId) -p $(pswd)
    cd ${TRAVIS_BUILD_DIR}/dockerfiles
    make docker_build_gpu
    make docker_push_gpu
- displayName: update microbadger
  script: "curl -X POST https://hooks.microbadger.com/images/carml/go-caffe2/AeELmVfl5ucS37qg1Me7vJwauZY="
